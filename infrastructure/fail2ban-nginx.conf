# Nginx Jail for HTTP Auth Failures
[nginx-http-auth]
enabled  = true
port     = http,https
logpath  = /var/log/nginx/error.log
maxretry = 3
bantime  = 3600
findtime = 600

# Nginx NoScript - Blocks script-related attacks
[nginx-noscript]
enabled  = true
port     = http,https
logpath  = /var/log/nginx/access.log
maxretry = 5
bantime  = 7200
findtime = 600

# Nginx Bad Bots - Blocks known malicious bots
[nginx-badbots]
enabled  = true
port     = http,https
logpath  = /var/log/nginx/access.log
maxretry = 2
bantime  = 86400  # 24 hours
findtime = 60

# Nginx No Proxy - Blocks proxy/VPN abuse
[nginx-noproxy]
enabled  = true
port     = http,https
logpath  = /var/log/nginx/access.log
maxretry = 2
bantime  = 86400  # 24 hours

# Nginx Request Limit - Blocks excessive requests
[nginx-req-limit]
enabled  = true
port     = http,https
logpath  = /var/log/nginx/error.log
maxretry = 10
findtime = 60
bantime  = 3600  # 1 hour

# Custom Scanner Detection
[nginx-scanner]
enabled  = true
port     = http,https
logpath  = /var/log/nginx/access.log
filter   = nginx-scanner
maxretry = 1
bantime  = 604800  # 7 days
findtime = 60
action   = iptables-multiport[name=NginxScanner, port="http,https", protocol=tcp]

# SSH Brute Force Protection
[sshd]
enabled  = true
port     = ssh
logpath  = /var/log/auth.log
maxretry = 3
bantime  = 86400  # 24 hours
findtime = 600
